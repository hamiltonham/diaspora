-#   Copyright (c) 2010, Diaspora Inc.  This file is
-#   licensed under the Affero General Public License version 3 or later.  See
-#   the COPYRIGHT file.

:javascript
  var genderized_languages = #{grammatical_gender_languages}

  $(document).ready(function(){

    $("#settings_nav li > a").live("click", function() {
      var target = "#"+$(this).attr('class');
      if( !$(target).is(":visible") ) {
        $(".settings_pane").fadeOut(200, function() {
          $(target).delay(200).fadeIn(200);
        });
      }
    });

    $("#user_language").change(function () {
      var gselected = $("#user_language option:selected").val();
      if ( $.inArray(gselected, genderized_languages) < 0 ) {
        $("#grammatical_gender_block").hide(800);
        $("#user_grammatical_gender").attr("disabled", "disabled");
      } else {
        $("#user_grammatical_gender").removeAttr("disabled");
        $("#grammatical_gender_block").show(800);
      }
    });
  });

#section_header
  %h2
    = t('settings')
  %ul#settings_nav
    %li=link_to t('profile'), edit_person_path(current_user.person)
    %li=link_to t('account'), edit_user_path(current_user)
    %li=link_to t('_services'), services_path

.span-19.prepend-5.last
  %h2
    = t('account')

  .span-8.append-2
    %h3
      = t('.your_handle')
    %p
      %b= current_user.diaspora_handle
  .span-8.last
    %h3
      = t('.your_email')
    %p
      = current_user.email

  %br
  %br
  %hr
  %br

  %h3 
    = t('.change_password')
  = form_for @user do |f|
    = f.error_messages

    %p
      = f.label :password, t('.new_password')
      = f.password_field :password
    %p
      = f.label :password_confirmation, t('password_confirmation')
      = f.password_field :password_confirmation

    .submit_block
      = link_to t('cancel'), edit_user_path(current_user)
      = t('or')
      = f.submit t('.change_password')

  %br
  %br
  %hr
  %br

  %h3 
    = t('.change_language')
  = form_for @user do |f|
    = f.error_messages

    %p
      = f.select :language, available_language_options
      = f.submit t('.change_language')
-#      %span#grammatical_gender_block{options_for_grammatical_gender_block}
-#        = "    " + t('.address_me_as')
-#        = select_tag 'user[grammatical_gender]', options_for_gender_select, :disabled => gender_select_disabled
-#      = f.submit t('.change_language')

  %br
  %br
  %hr
  %br

  .span-8.append-2
    %h3
      = t('.export_data')
    = link_to t('.download_xml'), users_export_path, :class => "button"
    = link_to t('.download_photos'), users_export_photos_path, :class => "button"

  .span-8.last
    %h3
      = t('.close_account')
    = link_to t('.close_account'), current_user,
                :confirm => t('are_you_sure'), :method => :delete,
                :class => "button"
